<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - StudyPro</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/dashboard.css" />
    <link rel="stylesheet" href="css/responsive.css" />
  </head>
  <body>
    <div class="dashboard-layout">

      <!-- Sidebar -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <div class="logo">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true">
              <rect width="32" height="32" rx="8" fill="#6366f1" />
              <path d="M16 8L12 12H15V20H17V12H20L16 8Z" fill="white" />
              <path d="M10 22H22V24H10V22Z" fill="white" />
            </svg>
            <span>StudyPro</span>
          </div>

          <button id="mobileMenuBtn" class="mobile-sidebar-toggle" aria-label="Toggle menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
          </button>
        </div>

        <nav class="sidebar-nav" aria-label="Main navigation">
          <a href="#" class="sidebar-link active">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M10 3L2 8L10 13L18 8L10 3Z" />
            </svg>
            <span>Dashboard</span>
          </a>
          <a href="#" class="sidebar-link">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M5 3C5 2.44772 5.44772 2 6 2H14C14.5523 2 15 2.44772 15 3V17L10 14L5 17V3Z" />
            </svg>
            <span>Tasks</span>
          </a>
          <a href="#" class="sidebar-link">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M3 4C3 3.44772 3.44772 3 4 3H16C16.5523 3 17 3.44772 17 4V16C17 16.5523 16.5523 17 16 17H4C3.44772 17 3 16.5523 3 16V4Z" />
            </svg>
            <span>Timetable</span>
          </a>
          <a href="#" class="sidebar-link">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10Z" />
            </svg>
            <span>Analytics</span>
          </a>
        </nav>

        <div class="sidebar-footer">
          <button class="btn-logout" onclick="Auth.logout()">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M3 3C3 2.44772 3.44772 2 4 2H12C12.5523 2 13 2.44772 13 3V5H11V4H5V16H11V15H13V17C13 17.5523 12.5523 18 12 18H4C3.44772 18 3 17.5523 3 17V3Z" />
              <path d="M15 8V6L19 10L15 14V12H9V8H15Z" />
            </svg>
            Logout
          </button>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="dashboard-main">
        <header class="dashboard-header">
          <div class="header-left">
            <h1>Welcome back, <span id="userName">Student</span>!</h1>
            <p>Here's what's happening with your studies today</p>
          </div>

          <div class="header-actions">
            <div class="search-wrapper">
              <input type="search" placeholder="Search tasks, subjects or notes..." aria-label="Search" id="dashboardSearch">
              <button class="search-btn" aria-label="Search">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M11 19a8 8 0 1 1 5.293-14.293A8 8 0 0 1 11 19zm7 2 4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </button>
            </div>

            <button class="icon-btn" aria-label="Notifications">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11a6 6 0 1 0-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span class="badge-dot"></span>
            </button>

            <div class="profile-dropdown">
              <img src="https://via.placeholder.com/40" alt="avatar" class="avatar" id="profileAvatar">
              <div class="profile-name">John</div>
            </div>
          </div>
        </header>

        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-card stat-elevated">
            <div class="stat-icon" style="background: linear-gradient(135deg,#eef2ff,#c7d2fe);">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="#6366f1"><path d="M12 2L2 7L12 12L22 7L12 2Z"/></svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Study Hours</p>
              <h3 class="stat-value" id="studyHours">0</h3>
              <p class="stat-meta">This week â€¢ 12% â†‘</p>
            </div>
          </div>

          <div class="stat-card stat-elevated">
            <div class="stat-icon" style="background: linear-gradient(135deg,#f3e8ff,#ddd6fe);">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="#8b5cf6"><path d="M9 12L11 14L15 10"/></svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Tasks Done</p>
              <h3 class="stat-value" id="tasksDone">0</h3>
              <p class="stat-meta">Completed â€¢ 5 today</p>
            </div>
          </div>

          <div class="stat-card stat-elevated">
            <div class="stat-icon" style="background: linear-gradient(135deg,#fff7ed,#fef3c7);">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="#f59e0b"><path d="M12 2L15 8.5L22 9.5L17 14.5L18 21.5L12 18"/></svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Total XP</p>
              <h3 class="stat-value" id="totalXP">0</h3>
              <p class="stat-meta">Level 5 â€¢ 2,450 XP</p>
            </div>
          </div>

          <div class="stat-card stat-elevated">
            <div class="stat-icon" style="background: linear-gradient(135deg,#ffeceb,#fecaca);">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="#ef4444"><path d="M13 2L3 14H12L11 22L21 10"/></svg>
            </div>
            <div class="stat-content">
              <p class="stat-label">Current Streak</p>
              <h3 class="stat-value"><span id="currentStreak">0</span> days</h3>
              <p class="stat-meta">Keep it up! ðŸ”¥</p>
            </div>
          </div>
        </div>

        <!-- Main panels: Left = actions & tasks, Right = calendar / charts -->
        <div class="panels-grid">
          <section class="panel panel-left">
            <div class="panel-header">
              <h2>Quick Actions</h2>
              <div class="panel-actions">
                <button class="btn-ghost" data-action="import">Import</button>
                <button class="btn-ghost" data-action="export">Export</button>
              </div>
            </div>

            <div class="actions-grid">
              <button class="action-btn" data-action="add-task">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 4V20M4 12H20"/></svg>
                <span>Add Task</span>
              </button>
              <button class="action-btn" data-action="timer">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="10"/></svg>
                <span>Start Timer</span>
              </button>
              <button class="action-btn" data-action="schedule">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H21V8H3V4ZM3 10H21V14H3V10Z"/></svg>
                <span>View Schedule</span>
              </button>
              <button class="action-btn" data-action="new-note">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L12 22M2 12L22 12"/></svg>
                <span>New Note</span>
              </button>
            </div>

            <div class="panel-block">
              <div class="panel-title-row">
                <h3>Upcoming Tasks</h3>
                <a href="#" class="view-all">View all</a>
              </div>

              <ul class="task-list" id="taskList">
                <!-- tasks injected by JS -->
              </ul>
            </div>
          </section>

          <aside class="panel panel-right">
            <div class="panel-block">
              <h3>Study Progress</h3>
              <div class="chart-placeholder">
                <!-- Chart.js will render a canvas here -->
                <div class="chart-legend">Weekly study time (placeholder chart)</div>
              </div>
            </div>

            <div class="panel-block">
              <h3>Upcoming Exams</h3>
              <ul class="exam-list">
                <li><strong>Physics Midterm</strong> â€” Apr 18, 2026</li>
                <li><strong>History Essay</strong> â€” Apr 25, 2026</li>
              </ul>
            </div>

            <div class="panel-block trusted-by">
              <p>Trusted by students at</p>
              <div class="university-logos">
                <span>Harvard</span>
                <span>MIT</span>
                <span>Stanford</span>
                <span>Oxford</span>
              </div>
            </div>
          </aside>
        </div>

        <!-- Recent Activity -->
        <div class="recent-activity">
          <h2>Recent Activity</h2>
          <div class="activity-list" id="activityList">
            <!-- activity injected by JS -->
          </div>
        </div>

      </main>
    </div>

    <!-- Add Task Modal -->
    <div class="modal" id="addTaskModal" aria-hidden="true">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create Task</h3>
          <button class="modal-close" data-modal-close>&times;</button>
        </div>
        <form id="addTaskForm" class="modal-form">
          <label>Title
            <input name="title" required placeholder="e.g., Read Chapter 5">
          </label>
          <label>Subject
            <input name="subject" placeholder="Math, Chemistry...">
          </label>
          <label>Due date
            <input name="dueDate" type="date">
          </label>
          <label>Estimated Minutes
            <input name="estimatedDuration" type="number" min="5" value="45">
          </label>
          <label>Priority
            <select name="priority">
              <option value="low">Low</option>
              <option value="normal" selected>Normal</option>
              <option value="high">High</option>
            </select>
          </label>
          <div class="modal-actions">
            <button type="button" class="btn-ghost" data-modal-close>Cancel</button>
            <button type="submit" class="btn-primary">Create Task</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Timer Modal -->
    <div class="modal" id="timerModal" aria-hidden="true">
      <div class="modal-content small">
        <div class="modal-header">
          <h3>Pomodoro Timer</h3>
          <button class="modal-close" data-modal-close>&times;</button>
        </div>

        <div class="timer-ui">
          <div class="timer-display" id="timerDisplay">25:00</div>
          <div class="timer-controls">
            <button id="timerStartBtn" class="btn-primary">Start</button>
            <button id="timerPauseBtn" class="btn-ghost">Pause</button>
            <button id="timerStopBtn" class="btn-ghost">Stop</button>
          </div>

          <div class="timer-settings">
            <label>Work (min)
              <input id="workMins" type="number" min="5" value="25">
            </label>
            <label>Short break (min)
              <input id="shortMins" type="number" min="1" value="5">
            </label>
            <label>Long break (min)
              <input id="longMins" type="number" min="5" value="15">
            </label>
          </div>
          <div class="timer-mode" id="timerMode">Mode: Work</div>
        </div>
      </div>
    </div>

    <div id="toastContainer" aria-hidden="true"></div>

    <!-- Scripts: load global helpers first, then Chart.js, auth/db, then timer & dashboard logic -->
    <script src="js/app.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script src="js/utils.js" defer></script>
    <script src="js/auth.js" defer></script>
    <script src="js/db.js" defer></script>
    <script src="js/timer.js" defer></script>
    <script src="js/dashboard.js" defer></script>
  </body>
</html>